0 : 43C00800;	ADDI SP, R0, 1024;
1 : 43000006;	ADDI IC, R0, 3 ; Encrypted image counter
2 : 40400020;	ADDI R1, R0, 16
3 : 03181800;	SL IC, IC, R1
4 : 43400096;	ADDI IP, R0, 75 ; Encrypted image pointer
5 : 40400018;	ADDI R1, R0, 12
6 : 035A1800;	SL IP, IP, R1
7 : 0358D000;	ADD IP, IC, IP
8 : 42C00808;	ADDI VP, R0, 1028 ; VRAM pointer
9 : 41001D66;	ADDI R4, R0,  3763 ; n
10 : 4140002E;	ADDI R5, R0, 23 ; k
11 : 4180116A;	ADDI R6, R0, 2229 ; m
12 : 41C00B42;	ADDI R7, R0, 1441 ; d

%DECRYPT:
13 : DC180000;	VLDH V1, IC
14 : 43800090;	CALL POWER
15 : 80000078;	CALL POWER
16 : 00000000;
17 : 00000000;
18 : 00000000;
19 : E828B000;	VSTB V5, VP
20 : 43180100;	ADDI IC, IC, 128
21 : 42D60080;	ADDI VP, VP, 64
22 : 531A02C8;	BE IC, IP, EXIT
23 : 00000000;
24 : 00000000;
25 : 00000000;
26 : 80000034;	JMP DECRYPT
27 : 00000000;
28 : 00000000;
29 : 00000000;

; Receives V1, R7 and returns V2, uses R9
%POWER:
30 : 4BDE0008;	SUBI SP, SP, 4
31 : 201CF000;	STW RA, SP
32 : 024E0000;	ADD R9, R7, R0 ; MOV
33 : C4A00200;	VSUB V3, V1, R0 ; MOV
34 : 43800130;	CALL MODULO
35 : 80000140;	CALL MODULO
36 : 00000000;
37 : 00000000;
38 : 00000000;
39 : C4240200;	VSUB V1, V3, R0 ; MOV
40 : 40400002;	ADDI R1, R0, 1
41 : C4420200;	VSUB V2, R1, R0 ; Result = 1

%WHILE:
42 : 52400250;	BE R9, R0, RETURN
43 : 00000000;
44 : 00000000;
45 : 00000000;
46 : 40400002;	ADDI R1, R0, 1
47 : 00921A00;	AND R2, R9, R1
48 : 508001E0;	BE R2, R0, ENDIF
49 : 00000000;
50 : 00000000;
51 : 00000000;
52 : C4630400;	VMUL V2, V2, V1
53 : C4A20200;	VSUB V3, V2, R0 ; MOV
54 : 438001D0;	CALL MODULO
55 : 80000140;	CALL MODULO
56 : 00000000;
57 : 00000000;
58 : 00000000;
59 : C4640200;	VSUB V2, V3, R0 ; MOV

%ENDIF:
60 : 40C00002;	ADDI R3, R0, 1
61 : 02523C00;	SR R9, R9, R3
62 : C4210400;	VMUL V1, V1, V1
63 : C4A00200;	VSUB V3, V1, R0 ; MOV
64 : 43800220;	CALL MODULO
65 : 80000140;	CALL MODULO
66 : 00000000;
67 : 00000000;
68 : 00000000;
69 : C4240200;	VSUB V1, V3, R0 ; MOV
70 : 800000A8;	JMP WHILE
71 : 00000000;
72 : 00000000;
73 : 00000000;

%RETURN:
74 : 139E0000;	LDW RA, SP
75 : 43DE0008;	ADDI SP, SP, 4
76 : 301C0000;	JR RA
76 : 301C0000;
77 : 00000000;
78 : 00000000;
79 : 00000000;

; Receives V3, R4 and returns on V3, uses V4 and V5
%MODULO:
80 : C4E46400;	VMUL V4, V3, R6
81 : C4E65E00;	VSR V4, V4, R5
82 : C5264400;	VMUL V5, V4, R4
83 : C4A54200;	VSUB V3, V3, V5
84 : F4A44200;	VCSUB V3, V3, R4
85 : 301C0000;	JR RA
86 : 00000000;
87 : 00000000;
88 : 00000000;

%EXIT:
89 : 00000000;	ADD R0, R0, R0
